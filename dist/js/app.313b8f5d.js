(function(t){function e(e){for(var n,s,a=e[0],l=e[1],c=e[2],h=0,d=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),o()}function o(){for(var t,e=0;e<r.length;e++){for(var o=r[e],n=!0,a=1;a<o.length;a++){var l=o[a];0!==i[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=o[0]))}return t}var n={},i={app:0},r=[];function s(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=n,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=l;r.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";o("85ec")},"0ca1":function(t,e,o){t.exports=o.p+"img/1.bf7093dc.png"},5697:function(t,e,o){t.exports=o.p+"img/noPreview.98b8933c.png"},"56d7":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("img",{attrs:{alt:"Vue logo",src:o("cf05")}}),n("VideoPreview",{attrs:{"pre-img":o("0ca1"),progress:""}}),n("VideoPreview",{attrs:{video:t.video,progress:""}}),n("HelloWorld",{on:{changeVideo:function(e){t.video=e}}})],1)},r=[],s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("input",{attrs:{type:"file",accept:"video/*"},on:{change:t.handleSubmit}})])},a=[],l={name:"HelloWorld",props:{msg:String},methods:{handleSubmit:function(t){console.log(t.target.files[0]),this.$emit("changeVideo",t.target.files[0])}}},c=l,u=o("2877"),h=Object(u["a"])(c,s,a,!1,null,"548dc6c0",null),d=h.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"video_box",class:t.boxClass,style:t.boxStyle,on:{mouseenter:t.mouseenter,mouseout:t.mouseout,mousemove:t.mousemove,touchstart:function(e){return e.preventDefault(),t.touchstart.apply(null,arguments)},touchmove:function(e){return e.preventDefault(),t.touchmove.apply(null,arguments)},touchend:t.touchend}},[t.coverImg&&t.showCover?n("img",{staticClass:"video_box-cover",style:{width:t.width+"px",height:t.height+"px"},attrs:{src:t.coverImg}}):t._e(),t.progress?n("div",{staticClass:"video_box-progress"},[n("div",{staticClass:"video_box-progress-content"},[n("div",{staticClass:"video_box-progress-line",style:{width:t.videoProgress+"%"}})])]):t._e(),t.preImage?t._e():n("img",{staticClass:"err",attrs:{src:o("5697"),alt:"未上传预览图或视频"}}),t.loading?n("div",{staticClass:"video_box-loading"}):t._e()])])},p=[],g=(o("a9e3"),o("99af"),o("b85c"));o("d3b7"),o("3ca3"),o("ddb0"),o("2b3d"),o("9861");function m(t,e,o){return new Promise((function(n){var i=0,r=document.createElement("video");r.src=URL.createObjectURL(t),r.currentTime=.1;var s=document.createElement("canvas");r.addEventListener("loadeddata",(function(){i=.2,console.log("".concat(Math.floor(100*i),"%"));var t=e.width||r.videoWidth,a=e.height||r.videoHeight,l=r.duration,c=Math.min(l,o);s.width=t*Math.min(c,10),s.height=a*Math.floor(c/10);for(var u=[],h=function(e){var n=document.createElement("video");n.src=r.src,n.currentTime=e*l/c+.1,u[e]=n,n.addEventListener("loadeddata",(function(){s.getContext("2d").drawImage(u[e],t*(e%10),a*Math.floor(e/10),t,a),u[e]=null,i+=.79/o,console.log("".concat(Math.floor(100*i),"%"))}))},d=0;d<c;d++)h(d);var f=setInterval((function(){if(v(u)){i=.99,console.log("".concat(Math.floor(100*i),"%")),window.clearInterval(f);var t=s.toDataURL("image/jpeg",.5);i=1,console.log("".concat(Math.floor(100*i),"%")),n(t)}}),50)}))}))}function v(t){var e,o=Object(g["a"])(t);try{for(o.s();!(e=o.n()).done;){var n=e.value;if(null!=n)return!1}}catch(i){o.e(i)}finally{o.f()}return!0}var b={name:"VideoPreview",props:{video:{type:File,default:null},preImg:{type:String},coverImg:{type:String},width:{type:[Number,String],default:240},height:{type:[Number,String],default:160},step:{type:Number,default:100},progress:{type:Boolean,default:!1}},data:function(){return{boxStyle:{backgroundImage:null,width:this.width+"px",height:this.height+"px",backgroundPosition:null,transition:null,transform:null,zIndex:null},boxClass:[],lineSize:10,videoProgress:0,preImage:null,showCover:!0,animateTimeout:null,loading:!1}},methods:{mouseenter:function(){this.showCover=!1},mousemove:function(t){t.offsetX<0||t.offsetX>this.width||t.offsetY<0||t.offsetY>this.height||!this.preImage||(this.videoProgress=Math.floor(t.offsetX*this.step/this.width))},mouseout:function(){this.boxStyle.backgroundPosition=null,this.showCover=!0},touchstart:function(){var t=this;this.boxStyle.transition="100ms transform ease-out",this.boxStyle.transform="scale(0.95)",this.boxStyle.zIndex="999999999999999999",this.animateTimeout=setTimeout((function(){t.boxStyle.transform="scale(1.5)"}),500),this.mouseenter()},touchmove:function(t){var e=t.touches[0].pageX-t.target.offsetLeft,o=t.touches[0].pageY-t.target.offsetTop;e<0||e>this.width||o<0||o>this.height||!this.preImage||(this.videoProgress=Math.floor(e*this.step/this.width))},touchend:function(){var t=this;window.clearTimeout(this.animateTimeout),"scale(0.95)"===this.boxStyle.transform?(this.boxStyle.transform=null,this.boxStyle.transition=null):"scale(1.5)"===this.boxStyle.transform&&(this.boxStyle.transition=null,this.boxStyle.transform=null,this.boxClass.push("bounce"),setTimeout((function(){t.boxClass=[]}),750)),this.boxStyle.zIndex=null,this.mouseout()}},created:function(){this.preImg&&(this.preImage=this.preImg)},watch:{preImg:function(t){this.preImage=t},video:function(t){var e=this;this.preImg||(this.loading=!0,m(t,{width:this.width,height:this.height},this.step).then((function(t){e.loading=!1,e.preImage=t})))},preImage:function(t){this.boxStyle.backgroundImage="url(".concat(t,")")},videoProgress:function(t){this.boxStyle.backgroundPosition="".concat(-t%this.lineSize*this.width,"px ").concat(-Math.floor(t/this.lineSize)*this.height,"px")}}},x=b,y=(o("eec2"),Object(u["a"])(x,f,p,!1,null,"21ec59da",null)),w=y.exports,S={name:"App",components:{HelloWorld:d,VideoPreview:w},data:function(){return{video:null}}},I=S,_=(o("034f"),Object(u["a"])(I,i,r,!1,null,null,null)),P=_.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(P)}}).$mount("#app")},"85ec":function(t,e,o){},cf05:function(t,e,o){t.exports=o.p+"img/logo.82b9c7a5.png"},eec2:function(t,e,o){"use strict";o("fc74")},fc74:function(t,e,o){}});
//# sourceMappingURL=app.313b8f5d.js.map